tweet_follower.tweet_count
,data = data)))
models %>% summarise(broom::tidy(mod))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = data)))
models %>% summarise(broom::tidy(mod))
models1 %>% summarise(rsq = summary(model)$r.squared)
models %>% summarise(rsq = summary(mod)$r.squared)
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = cur_data())))
models %>% summarise(broom::tidy(mod))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
)))
models %>% summarise(broom::tidy(mod))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = .)))
models %>% summarise(broom::tidy(mod))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df_combined_left)))
models %>% summarise(broom::tidy(mod))
df_1 <- df_combined_left %>%nest_by(collection_slug)
models <-
df_1 %>%
mutate(mod = list(lm(df_1$total_price_eth ~
df_1$average_followers +
df_1$total_tweets +
df_1$total_tweets * df_1$average_followers
,data = df_1)))
df_combined_left
models <-
df_1 %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df_combined_left)))
models %>% summarise(broom::tidy(mod))
models <-
df_1 %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df_1)))
models %>% summarise(broom::tidy(mod))
models <-
df_1 %>%
mutate(mod = list(lm(total_price_eth ~
average_followers +
total_tweets +
total_tweets * average_followers
,data = df_1)))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df_combined_left %>% nest_by(collection_slug))))
models %>% summarise(broom::tidy(mod))
models %>% summarise(rsq = summary(mod)$n())
models %>% summarise(rsq = summary(mod)$n
models %>% summarise(rsq = summary(mod)$n)
models1 <- mtcars %>%
nest_by(cyl) %>%
mutate(model = list(lm(mpg ~ wt, data = data)))
models %>% summarise(rsq = summary(mod)$n)
models %>% summarise(rsq = summary(mod)$count)
models %>% summarise(rsq = summary(mod)$df)
nest_by() %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df_combined_left %>% nest_by(collection_slug))))
nest() %>%
mutate(mod = list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df_combined_left %>% nest_by(collection_slug))))
library(purrr)
slug_model <- function(df) {
lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df)
}
df_1 <- df_combined_left %>%nest_by(collection_slug)
df_combined_left <- merge(x = tweet_group_day_slug ,y = subset_nfts,how='left', by=c("datetime", "collection_slug"))
nft_price <- df_combined_left$total_price_eth
tweet_mean_followers <- df_combined_left$average_followers
tweet_count <- df_combined_left$total_tweets
tweet_follower.tweet_count <- tweet_mean_followers * tweet_count
# summary(lm(nft_price ~
#              tweet_mean_followers +
#              tweet_count +
#              tweet_follower.tweet_count))
slug_model <- function(df) {
lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df)
}
df_1 <- df_combined_left %>%nest_by(collection_slug)
models <-  map(df_1,df_combined_left)
models <- map(df_1$data,df_combined_left)
models <- map(df_1$data,slug_model)
by_slug <- df_1 %>%
mutate(model = map(data,slug_model))
by_slug <- df_1 %>%
mutate(model69 = map(data,slug_model))
df_1 <- df_1 %>%
mutate(model69 = map(data,slug_model))
df_1 <- df_1 %>%
mutate(model69 = map(df_1$data,slug_model))
df_1 <- df_1 %>%
mutate(model69 = list(map(df_1$data,slug_model)))
models <- map(df_1$data,slug_model)
df_combined_left <- merge(x = tweet_group_day_slug ,y = subset_nfts,how='left', by=c("datetime", "collection_slug"))
nft_price <- df_combined_left$total_price_eth
tweet_mean_followers <- df_combined_left$average_followers
tweet_count <- df_combined_left$total_tweets
tweet_follower.tweet_count <- tweet_mean_followers * tweet_count
# summary(lm(nft_price ~
#              tweet_mean_followers +
#              tweet_count +
#              tweet_follower.tweet_count))
slug_model <- function(df) {
lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$total_tweets * df_combined_left$average_followers
,data = df)
}
df_1 <- df_combined_left %>%nest_by(collection_slug)
models <- map(df_1$data,slug_model)
View(models)
df1$data[[0]]
df_1[[0]]
df_1[0]
df_1[0][0]
View(df_1)
rm(models)
df_combined_left = df_combined_left %>% filter(collection_slug == '10ktf')
df_combined_left = df_combined_left %>% filter(collection_slug == '10ktf')
nft_price <- df_combined_left$total_price_eth
tweet_mean_followers <- df_combined_left$average_followers
tweet_count <- df_combined_left$total_tweets
tweet_follower.tweet_count <- tweet_mean_followers * tweet_count
summary(lm(nft_price ~
tweet_mean_followers +
tweet_count +
tweet_follower.tweet_count))
by_slug <- df_combined_left %>%
group_by(collection_slug) %>%
nest()
by_slug
df_combined_left <- merge(x = tweet_group_day_slug ,y = subset_nfts,how='left', by=c("datetime", "collection_slug"))
by_slug <- df_combined_left %>%
group_by(collection_slug) %>%
nest()
by_slug
slug_model <- function(x) {
lm(nft_price ~
tweet_mean_followers +
tweet_count +
tweet_follower.tweet_count
,data = df)
}
models <- map(by_slug$data,slug_model)
library ('dplyr')
# library ('plyr')
library ('stats')
library ('broom')
library('tidyr')
library('purrr')
options(scipen=999)
by_slug <- df_combined_left %>%
group_by(collection_slug) %>%
nest()
slug_model <- function(x) {
lm(nft_price ~
tweet_mean_followers +
tweet_count +
tweet_follower.tweet_count
,data = df)
}
models <- purrr::map(by_slug$data,slug_model)
slug_model <- function(df) {
lm(nft_price ~
tweet_mean_followers +
tweet_count +
tweet_follower.tweet_count
,data = df)
}
models <- purrr::map(by_slug$data,slug_model)
by_slug1 <- by_slug1 %>%
mutate(model = map(by_slug$data,slug_model))
by_slug1 <- by_slug %>%
mutate(model = map(by_slug$data,slug_model))
by_slug <- by_slug %>%
mutate(model = map(by_slug$data,slug_model))
by_slug <- by_slug %>%
mutate(model = map(data,slug_model))
View(by_slug)
by_slug
View(by_slug)
by_slug[0]
by_slug[1]
by_slug[:][1]
by_slug[][1]
by_slug[0][1]
by_slug[0:5][1]
by_slug[0:5]
by_slug[1]
by_slug[2]
by_slug[2][0]
by_slug[2][1]
by_slug[2][:]
by_slug[2][1,]
tibble(by_slug[2][1,])
data.frame(by_slug[2][1,])
by_slug[4]
by_slug[2]
by_slug[2][4][1]
by_slug[2][4][1,]
by_slug[2][4,][1]
data.frame(by_slug[2][4,][1])
by_slug %>% summarise(broom::tidy(model))
by_slug
by_slug.info()
by_slug
by_slug[3]
by_slug_models <- by_slug$model
View(by_slug_models)
library('tibble')
as_tibble(by_slug_models)
View(by_slug_models)
library ('dplyr')
# library ('plyr')
library ('stats')
library ('broom')
library('tidyr')
library('purrr')
library('tibble')
library('modelr')
options(scipen=999)
# ---- Tweet import and format ----
source_tweets <- read.csv("tweets_clean_rstudio.csv",
header=TRUE)
subset_tweets = subset(source_tweets,select = -c(tweet_text,reply_tweetid,tweet_hashtags,user_raw_description,user_description_links,user_location,user_protected,user_links,user_label,tweet_sent_language))
subset_tweets$tweetid <- as.character(subset_tweets$tweetid)
subset_tweets$username <- as.character(subset_tweets$username)
subset_tweets$user_id <- as.character(subset_tweets$user_id)
subset_tweets$tweet_datetime <- as.Date(subset_tweets$tweet_datetime)
subset_tweets$user_creation_date <- as.Date(subset_tweets$user_creation_date)
subset_tweets$user_verified <- as.logical(subset_tweets$user_verified)
subset_tweets$tweet_likes <- as.integer(subset_tweets$tweet_likes)
subset_tweets$retweets <- as.integer(subset_tweets$retweets)
subset_tweets$user_followers_count <- as.integer(subset_tweets$user_followers_count)
subset_tweets$user_following_count <- as.integer(subset_tweets$user_following_count)
subset_tweets$user_statuses_count <- as.integer(subset_tweets$user_statuses_count)
subset_tweets$user_favourites_count <- as.integer(subset_tweets$user_favourites_count)
subset_tweets = subset_tweets %>% filter(tweet_datetime > '2021-05-30')
names(subset_tweets)[3] <- 'datetime'
names(subset_tweets)[4] <- 'collection_slug'
rm(source_tweets)
# ---- NFT import and format ----
source_nfts <- read.csv("nfts_clean.csv",
header=TRUE)
subset_nfts = subset(source_nfts,select = -c(sampling,bid_amount,total_price_wei))
rm(source_nfts)
subset_nfts$asset_token_id <- as.character(subset_nfts$asset_token_id)
subset_nfts$from_account_address <- as.character(subset_nfts$from_account_address)
subset_nfts$event_timestamp <- as.Date(subset_nfts$event_timestamp)
names(subset_nfts)[4] <- 'datetime'
# ---- Groupby functions ----
# subset_tweets
foll = 0
likes = 0
retw = 0
tweet_group_day_slug =
subset_tweets %>%
dplyr::group_by(datetime,collection_slug) %>%
dplyr::filter(user_followers_count >= foll & tweet_likes >= likes & retweets >= retw ) %>%
dplyr::summarise(
total_tweets = n(),
average_likes = round(mean(tweet_likes),5),
average_retweets = round(mean(retweets),5),
average_followers = round(mean(user_followers_count),5),
average_sent = round(mean(tweet_sent_score),5),
.groups='drop')
# subset_nfts
lag_days = 1
subset_nfts$datetime <- lag(subset_nfts$datetime,lag_days)
#---- Analysis ----
df_combined_left <- merge(x = tweet_group_day_slug ,y = subset_nfts,how='left', by=c("datetime", "collection_slug"))
# df_combined_left = df_combined_left %>% filter(collection_slug == '10ktf')
nft_price <- df_combined_left$total_price_eth
tweet_mean_followers <- df_combined_left$average_followers
tweet_count <- df_combined_left$total_tweets
tweet_follower.tweet_count <- tweet_mean_followers * tweet_count
# summary(lm(nft_price ~
#              tweet_mean_followers +
#              tweet_count +
#              tweet_follower.tweet_count))
# models %>% summarise(broom::tidy(mod))
# models %>% summarise(rsq = summary(mod)$df)
models <- df_combined_left %>%
group_by(collection_slug) %>%
nest() %>%
summarise(mod=list(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=.))
#
# by_slug <- df_combined_left %>%
#   group_by(collection_slug) %>%
#   nest()
#
# slug_model <- function(df) {
#   lm(df$total_price_eth ~
#        df$average_followers +
#        df$total_tweets +
#        df$average_followers*df$total_tweets
#      ,data = df)
# }
#
#
# models <- purrr::map(by_slug$data,slug_model)
#
# by_slug_models <- by_slug %>%
#   mutate(model = map(data,slug_model))
#
# by_slug_resid <- by_slug_models %>%
#   mutate(
#     resids = map2(data, model, add_residuals)
#   )
models$data
models$model
models$mod
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod=list(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=.)) %>%
summarise(tidy(mod))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod=list(lm(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=.))) %>%
summarise(tidy(mod))
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod=list(lm(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=data))) %>%
summarise(tidy(mod))
library ('dplyr')
# library ('plyr')
library ('stats')
library ('broom')
library('tidyr')
library('purrr')
library('tibble')
library('modelr')
options(scipen=999)
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod=list(lm(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=data))) %>%
summarise(tidy(mod))
rm(models)
models <-
df_combined_left %>%
nest_by(collection_slug) %>%
mutate(mod=list(lm(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=data))) %>%
summarise(tidy(mod))
models <-
df_combined_left %>%
nest_by(df_combined_left$collection_slug) %>%
mutate(mod=list(lm(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=data))) %>%
summarise(tidy(mod))
models <-
df_combined_left %>%
nest_by(df_combined_left$collection_slug) %>%
mutate(mod=list(lm(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=data))) %>%
summarise(tidy(mod))
rm(mod)
models <-
df_combined_left %>%
nest_by(df_combined_left$collection_slug) %>%
mutate(mod=list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$average_followers*df_combined_left$total_tweets,
data=data))) %>%
summarise(tidy(mod))
View(models)
models <-
df_combined_left %>%
nest_by(df_combined_left$collection_slug) %>%
mutate(mod=list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$average_followers*df_combined_left$total_tweets,
data=df_combined_left$collection_slug))) %>%
summarise(tidy(mod))
models <-
df_combined_left %>%
nest_by(df_combined_left$collection_slug) %>%
mutate(mod=list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$average_followers*df_combined_left$total_tweets,
data=nest_by(df_combined_left$collection_slug)))) %>%
summarise(tidy(mod))
models <-
df_combined_left %>%
nest_by(df_combined_left$collection_slug) %>%
mutate(mod=list(lm(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$average_followers*df_combined_left$total_tweets,
data=.))) %>%
summarise(tidy(mod))
View(models)
models <- df_combined_left %>%
group_by(collection_slug) %>%
nest() %>%
summarise(mod=list(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$average_followers*df_combined_left$total_tweets,
data=.))
models$model
models$mod
df <- df_combined_left %>%  group_by(collection_slug) %>% nest()
View(df)
models <- df %>%
summarise(mod=list(df_combined_left$total_price_eth ~
df_combined_left$average_followers +
df_combined_left$total_tweets +
df_combined_left$average_followers*df_combined_left$total_tweets,
data=.))
models <- df %>%
summarise(mod=list(df$total_price_eth ~
df$average_followers +
df$total_tweets +
df$average_followers*df$total_tweets,
data=df))
